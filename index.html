<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>a secret you weren’t meant to find.</title>
  <style>
    body {
      background-color: #0d1117;
      color: #c9d1d9;
      font-family: monospace;
      padding: 2em;
      margin: 0;
      line-height: 1.6;
      text-align: left;
      cursor: pointer;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .quote {
      font-size: 1.4em;
      white-space: pre-wrap;
      overflow-wrap: break-word;
      display: inline-block; /* hug text background */
    }

    .selected {
      background-color: #3390ff; /* blue selection */
      color: white;
    }

    .ascii {
      font-size: 0.48em;
      line-height: 1.1;
      white-space: pre-wrap;
      word-break: break-word;
      text-align: center;
    }

    .ascii-wrapper {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .cursor {
      display: inline-block;
      background-color: #c9d1d9;
      width: 8px;
      height: 1em;
      vertical-align: bottom;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      50% { background-color: transparent; }
    }

    .footer {
      margin-top: 4em;
      font-size: 0.9em;
      color: #6e7681;
    }

    .title-tag {
      position: fixed;
      bottom: 1em;
      right: 1em;
      font-size: 0.95em;
      color: #8b949e;
      font-style: italic;
      text-align: right;
      line-height: 1.4;
      width: max-content;
      pointer-events: none;
    }

    .audio-prompt {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(13, 17, 23, 0.9);
      padding: 0.5em 1em;
      border: 1px solid #6e7681;
      border-radius: 6px;
      color: #8b949e;
      font-size: 0.75em;
      text-align: center;
      z-index: 9999;
      pointer-events: none;
      animation: fadeout 1s ease 2s forwards;
    }

    @keyframes fadeout {
      to { opacity: 0; visibility: hidden; }
    }
  </style>
</head>
<body>
  <div class="quote" id="quote"></div>
  <div class="ascii-wrapper" id="asciiWrapper" style="display: none;">
    <pre class="ascii" id="asciiArt"></pre>
  </div>
  <div class="cursor"></div>

  <div class="footer" id="footer">scan quietly. it's not for everyone.</div>
  <div class="title-tag">done, done redeeming unfaithful qualities</div>
  <div class="audio-prompt" id="audioPrompt">click anywhere to unmute</div>

  <audio id="bg-audio" autoplay loop muted playsinline>
    <source src="ambient.mp3" type="audio/mpeg" />
  </audio>

  <script>
    const quotes = [
      "you parted your lips like it was sacred.\neven in silence, my kisses never let you second guess.\ni moved like someone who knew the way.\nand still, you told me: slower so it stain.",
      "i undressed like a confession.\nyou stayed like absolution.\nthere was no shame between us,\njust skin learning how to say: let me be yours.",
      "i feel you wanting more—\nto crawl into the hollowness beneath my ribs,\nto echo inside me\nlike I’m echoing inside you.",
      "we talked\nuntil the sun appeared—\neach blink layered\nwith chuckles,\nknowing it’s finally here.",
      "i want to tell you something—\nwith my tongue,\nwith my hands,\nwith the way our bodies slow-dance.",
      "i kiss a line down your belly\nas your legs part on instinct.\nyour breath stutters—\nyou beg me to take all of it,\nand i do, as you plead.",
      "don’t cum just yet.\ni want to stay in this ache with you.\nin this pause between need and surrender.\nthis is the closest i’ve felt to safety.",
      "your smile seasons the food.\nyour hands wash every dish\nlike they’re cleansing something \nsacred than this meal.",
      "i didn’t need to ask.\nyou just curled into me like you always belonged.\nmy hand on your lower back.\nyour breath undoing every apology i rehearsed.",
      "i compliment you\non the tattoo across your lips —\nafraid your mom would see.\nlet my breath become a breeze —\nhugging your smile forever.",
      "i wanted you to speak it aloud,\nto let the veil fall,\nto confess that yesterday was more real\nthan the masks we wear today. \nso why pretend the sun has not risen? \neven shadows admit their devotion to light."
    ];


    const asciiArt = `
      _    __      ___ __  __  _  
 /  /_|  / _ /  /(_  /__)/__)/_| 
(__(  | (__)(__/(___/ ( / ( (  | 
`;

 const output = document.getElementById("quote");
    const cursor = document.querySelector(".cursor");
    const asciiWrapper = document.getElementById("asciiWrapper");
    const asciiEl = document.getElementById("asciiArt");
    const audio = document.getElementById("bg-audio");
    const footer = document.getElementById("footer");

    const seen = localStorage.getItem("ddruq_seen_quote");

    if (seen) {
      if (cursor) cursor.style.display = "none";
      if (output) output.style.display = "none";
      asciiWrapper.style.display = "flex";
      asciiEl.textContent = asciiArt;
      if (footer) footer.remove();
    } else {

      // 50% chance of teaser
      let useTeaser = Math.random() < 0.5;

      // Pick teaser from beginning of a random quote
      let teaserText = useTeaser ? quotes[Math.floor(Math.random() * quotes.length)].substr(0, 6 + Math.floor(Math.random() * 3)) : "";

      // Pick full quote different from teaser
      let fullQuote;
      do {
        fullQuote = quotes[Math.floor(Math.random() * quotes.length)];
      } while (teaserText && fullQuote.startsWith(teaserText));

      let charIndex = 0;
      let deleting = false;
      let stage = useTeaser ? "teaser" : "full";

      function typeQuote() {
        if (stage === "teaser") {
          if (!deleting) {
            output.textContent += teaserText.charAt(charIndex);
            charIndex++;
            if (charIndex === teaserText.length) {
              deleting = true;
              setTimeout(typeQuote, 800);
              return;
            }
          } else {
            output.textContent = output.textContent.slice(0, -1);
            if (output.textContent.length === 0) {
              deleting = false;
              charIndex = 0;
              stage = "full";
            }
          }
          setTimeout(typeQuote, deleting ? 40 : 120);

        } else if (stage === "full") {
          if (charIndex < fullQuote.length) {
            output.textContent += fullQuote.charAt(charIndex);
            charIndex++;
            setTimeout(typeQuote, 100);
          } else {
            // Full quote typed, wait 3s, then Ctrl+A effect hugging text
            setTimeout(() => {
              output.innerHTML = `<span class="selected">${fullQuote}</span>`;
              setTimeout(() => {
                output.textContent = "";
                cursor.style.display = "none";
              }, 800); // show selection briefly
            }, 3000);
          }
        }
      }

      typeQuote();
      localStorage.setItem("ddruq_seen_quote", "true");
    }

    document.addEventListener("click", () => {
      if (audio.muted) {
        audio.muted = false;
        audio.play().catch(() => {});
      }
    }, { once: true });
  </script>
</body>
</html>
